<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jk.dao.ZcDao" >

  <!--分页查询-->
  <select id="queryCommodity" parameterType="hashMap" resultType="com.jk.model.commodity.CommodityModel">
      select *  from t_item te
      left join t_commoditytype ty on ty.typeId=te.TypeId
      left join brand br on br.itemId=te.id
      <include refid="sq"></include>
      LIMIT #{start},#{end}
  </select>

  <!--条件查询-->
    <sql id="sq">
        <where>
            <if test="result.typeIds!=null and result.typeIds!=''">
               and ty.typeId = #{result.typeIds}
            </if>
            <if test="result.commodityName!=null and result.commodityName!=''">
                and te.commodityName = #{result.commodityName}
            </if>
            <if test="result.status!=null and result.status!=''">
                and te.status = #{result.status}
            </if>
            <if test="result.is!=null and result.is!=''">
                and te.newProduct = #{result.is} or te.selllikeHotCakes = #{result.is}
            </if>
            <if test="result.dran!=null and result.dran!=''">
                and br.id = #{result.dran}
            </if>
        </where>
    </sql>

    <!--查询回显-->
    <select id="loadOneModel" parameterType="int" resultType="com.jk.model.commodity.CommodityModel">
        select *,ty.TypeId TypeIds  from t_item te
        left join t_commoditytype ty on ty.typeId=te.TypeId
        left join brand br on br.itemId=te.id
        WHERE te.id = #{value}
    </select>

    <!--修改-->
    <update id="updCommodity" parameterType="com.jk.model.commodity.CommodityModel">
        UPDATE t_item SET commodityName = #{commodityName},artNo = #{artNo},commodityPrice = #{commodityPrice},TypeId = #{TypeId},itemId = #{itemId}  ,pictureUrl = #{pictureUrl}  WHERE id = 1
    </update>

    <insert id="addCommodity" parameterType="com.jk.model.commodity.CommodityModel">

         INSERT into t_item(commodityName,artNo,commodityPrice,status,newProduct,selllikeHotCakes,inventory,TypeId,pictureUrl,itemId)
         VALUES(
             #{commodityName},
             #{artNo},
             #{commodityPrice},
             1,
             1,
             1,
             #{inventory},
             #{TypeId},
             #{pictureUrl},
             #{itemId}
         )

    </insert>

    <!--查询商品分类-->
    <select id="queryClassify" resultType="com.jk.model.commodity.CommodityTypeModel">
        select ty.*,it.inventory as inventory from  t_commoditytype ty
        left join t_item it on it.TypeId=ty.itemId
    </select>
</mapper>