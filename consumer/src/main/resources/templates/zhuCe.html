<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../js/jquery-1.8.0.js"></script>
    <link rel="stylesheet" type="text/css" href="../js/easyui-1.7.0/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="../js/easyui-1.7.0/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../js/easyui-1.7.0/demo.css">
    <script type="text/javascript" src="../js/easyui-1.7.0/jquery.min.js"></script>
    <script type="text/javascript" src="../js/easyui-1.7.0/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../js/easyui-1.7.0/plugins/jquery.datagrid.js"></script>
    <script src="../uploadify/jquery.uploadify.js"></script>
    <link rel="stylesheet" href="../uploadify/uploadify.css">


</head>
<body>
<form id="formId">
    <table align="center">
        <tr>
            <td>账号</td>
            <td><input class="easyui-textbox" name="username" data-options="iconCls:'icon-search'" style="width:300px" iconCls="icon-man">
            </td>
        </tr>
        <tr>
            <td>密码</td>
            <td><input class="easyui-textbox" name="password" data-options="iconCls:'icon-search'" style="width:300px" iconCls="icon-lock">
            </td>
        </tr>
        <tr>
            <td>昵称</td>
            <td><input class="easyui-textbox" name="nickname" data-options="iconCls:'icon-search'" style="width:300px" iconCls="icon-lock">
            </td>
        </tr>
        <tr>
            <td>密保手机号</td>
            <td><input  name="phone" type="text" class="easyui-textbox"></input> <br>
                <a href="javascript:huo()" class="easyui-linkbutton">获取验证码</a>   <span id="date"></span>
                <input id="code" name="code" type="text" class="easyui-textbox"></input>
            </td>
        </tr>
        <tr>
            <td>性别</td>
            <td>
                <div data-toggle="topjui-radio">
                        <div style="margin-bottom:20px">
                            <input data-toggle="topjui-radiobutton" name="gender" value="1" label="男:">
                        </div>
                        <div style="margin-bottom:20px">
                            <input data-toggle="topjui-radiobutton" name="gender" value="2" label="女:">
                        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td>头像</td>
            <td>
                <input type="hidden" name="mimg" id="imgId"/>
                <input type="file" id="imgFileBTN" />
                <div id="showImgDiv" style="width: 150px;height: 200px;border-style:solid;border-width:1px; border-color:black;">
                    <img src="" id="showImg" style="width: 80px">
                </div>
                <div id="showBars" ></div>
            </td>
        </tr>
        <tr>
            <td colspan="2"><a href="javascript:add()"  class="easyui-linkbutton" style="width:45%;height:32px">注册</a></td>
        </tr>
    </table>
</form>
</body>
<script>
        function add(){
            $.ajax({
                url:"../xxf/addMembers",
                data:$("#formId").serialize(),
                success:function(data){
                    if(data=="1"){alert("手机验证码错误")}
                    if(data=="0")
                    location.href="../toshow/tofrontLogin"
                }
            })
        }
    function huo(){
        num=$("input[name='phone']").val();
        $.ajax({
            url:"../xxf/huoCode",
            data:$("#formId").serialize(),
            type:"post",
            success:function(data){
                if(data=="0"){
                    setInterval('countDown()',1000);
                    alert("提示消息","短信已发送,请注意查看")
                }else{
                    alert("提示消息","请稍后再试")
                }
            }
        })
    }
    var time=60;
    function countDown(){
        if(time>0){
            $("#date").html(time--)
        }else{
            $("#date").css('display','none');
        }
    }

        $(function(){
            //文件域的id
            $("#imgFileBTN").uploadify({
                //前台请求后台的url 不可忽略的参数
                'uploader' :"../xxf/uploadNewsImg",
                //插件自带 不可忽略的参数
                'swf' : '../js/uploadify/uploadify.swf',
                //撤销按钮的图片路径""
                'cancelImg' : '../js/uploadify/uploadify-cancel.png',
                //如果为true 为自动上传 在文件后 为false 那么它就要我们自己手动点上传按钮
                'auto' : true,
                //可以同时选择多个文件 默认为true 不可忽略
                'multi' : false,
                //给上传按钮设置文字
                'buttonText' : '上传图片',
                //上传后队列是否消失
                'removeCompleted' : true,
                'removeTimeout' : 1,
                //上传文件的个数
                'uploadLimit' : 2,
                'fileTypeExts' : '*.jpg;*.jpge;*.gif;*.png',
                'fileSizeLimit' : '2MB',
                //给div的进度条加背景 不可忽略
                'queueID' : 'showBars',
                // controller层方法中接收文件的参数名, 参数名为自定义
                'fileObjName' : 'img',
                //      上传成功后的回调函数
                'onUploadSuccess' : function(file, data, response) {
                    alert(data);
                    data = data.replace("\"","").replace("\"","");
                    $("#showImg").attr("src","../upload/"+data);
                    $("#imgId").val(data);
                }

            });
        });

</script>
</html>